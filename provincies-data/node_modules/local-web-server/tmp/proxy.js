const http = require('http')
const httpProxy = require('http-proxy')
const url = require('url')

const proxy = httpProxy.createProxyServer({
  target: 'http://registry.npmjs.org/',
  changeOrigin: true
})

const server = http.createServer(function (req, res) {
  const pathname = url.parse(req.url).pathname
  if (/^\/api/.test(pathname)) {
    proxy.web(req, res)
  } else {
    res.end('nowt')
  }
})
server.listen(8000)
